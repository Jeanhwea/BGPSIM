<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>BGP模拟器 by Jeanhwea</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">BGP模拟器</h1>
      <h2 class="project-tagline">An BGP protocol simulator</h2>
      <a href="https://github.com/Jeanhwea/BGPSIM" class="btn">View on GitHub</a>
      <a href="https://github.com/Jeanhwea/BGPSIM/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/Jeanhwea/BGPSIM/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="bgp-模拟器" class="anchor" href="#bgp-%E6%A8%A1%E6%8B%9F%E5%99%A8" aria-hidden="true"><span class="octicon octicon-link"></span></a>BGP 模拟器</h1>

<hr>

<h1>
<a id="1-简介" class="anchor" href="#1-%E7%AE%80%E4%BB%8B" aria-hidden="true"><span class="octicon octicon-link"></span></a>1 简介</h1>

<p>这是一个简单的BGP协议的模拟器，主要参照文档
<a href="http://www.rfc-editor.org/rfc/rfc1771.txt" title="rfc1771">rfc1771</a>
来设计和实现。</p>

<h1>
<a id="2-报文格式" class="anchor" href="#2-%E6%8A%A5%E6%96%87%E6%A0%BC%E5%BC%8F" aria-hidden="true"><span class="octicon octicon-link"></span></a>2 报文格式</h1>

<h2>
<a id="21-报文首部格式" class="anchor" href="#21-%E6%8A%A5%E6%96%87%E9%A6%96%E9%83%A8%E6%A0%BC%E5%BC%8F" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.1 报文首部格式</h2>

<p>每个BGP报文使用相同的首部， 其它的部分随着报文类型不同而变化，首部格式如下：</p>

<pre><code>   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   +                                                               +
   |                                                               |
   +                                                               +
   |                           Marker                              |
   +                                                               +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |          Length               |      Type     |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre>

<h2>
<a id="22-open报文格式" class="anchor" href="#22-open%E6%8A%A5%E6%96%87%E6%A0%BC%E5%BC%8F" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.2 OPEN报文格式</h2>

<p>在TCP协议建立后，第一个发出的报文就是OPEN报文，如果OPEN报文被接受方接收到，
则接受方返回KEEPALIVE报文，用于确认OPEN报文发送成功。当OPEN报文发生被确认后，
UPDATE报文，KEEPALIVE报文和NOTIFICATION报文将可以进行交换。</p>

<p>除了BGP的首部，OPEN报文还应包含如下字段：</p>

<pre><code>   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+
   |    Version    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     My Autonomous System      |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |           Hold Time           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                         BGP Identifier                        |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Opt Parm Len  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   |                       Optional Parameters                     |
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre>

<h2>
<a id="23-update报文格式" class="anchor" href="#23-update%E6%8A%A5%E6%96%87%E6%A0%BC%E5%BC%8F" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.3 UPDATE报文格式</h2>

<p>UPDATE报文是用于传递BGP对等体之间的路由信息的。这些信息可以用于构建多个自治系统
之间关系图。通过应用规则来加以讨论，路由信息环路和一些其他的异常可以被检测并从自
治系统间路由除去。</p>

<p>除了BGP的首部，UPDATE报文还应包含如下字段：</p>

<pre><code>   +-----------------------------------------------------+
   |   Unfeasible Routes Length (2 octets)               |
   +-----------------------------------------------------+
   |  Withdrawn Routes (variable)                        |
   +-----------------------------------------------------+
   |   Total Path Attribute Length (2 octets)            |
   +-----------------------------------------------------+
   |    Path Attributes (variable)                       |
   +-----------------------------------------------------+
   |   Network Layer Reachability Information (variable) |
   +-----------------------------------------------------+
</code></pre>

<h2>
<a id="24-keepalive报文格式" class="anchor" href="#24-keepalive%E6%8A%A5%E6%96%87%E6%A0%BC%E5%BC%8F" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.4 KEEPALIVE报文格式</h2>

<p>BGP不以任何传输协议为基础的保活机制确保对等体可达。相反，keepalive报文 
对等体之间不频繁地交换信息会引起HoldTimer过期。 KEEPALIVE报文之间合理
的最大时间被置为保持时间间隔的三分之一。</p>

<p>如果协商保持时间间隔是零，那么KEEPALIVE报文将不会被发送。</p>

<p>KEEPALIVE报文只包括BGP首部的19个字节。</p>

<h2>
<a id="25-notification报文格式" class="anchor" href="#25-notification%E6%8A%A5%E6%96%87%E6%A0%BC%E5%BC%8F" aria-hidden="true"><span class="octicon octicon-link"></span></a>2.5 NOTIFICATION报文格式</h2>

<p>NOTIFICATION报文用于报告连接的错误。一旦发送NOTIFICATION报文过后，
就要立即断开BGP的链接。</p>

<p>除了BGP的首部，NOTIFICATION报文还应包含如下字段：</p>

<pre><code>   0                   1                   2                   3
   0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | Error code    | Error subcode |           Data                |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</code></pre>

<h1>
<a id="参考资料" class="anchor" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99" aria-hidden="true"><span class="octicon octicon-link"></span></a>参考资料</h1>

<p>[1] : <a href="http://www.rfc-editor.org/rfc/rfc1771.txt">http://www.rfc-editor.org/rfc/rfc1771.txt</a> "rfc1771"</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/Jeanhwea/BGPSIM">BGP模拟器</a> is maintained by <a href="https://github.com/Jeanhwea">Jeanhwea</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>

